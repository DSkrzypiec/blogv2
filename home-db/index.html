<!DOCTYPE html><html lang="en" data-astro-cid-gvpn4u4b> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Home Database</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.26/dist/katex.min.css" crossorigin="anonymous"><style>*,*:before,*:after{box-sizing:border-box}html,body{max-width:100%;overflow-x:hidden}html{-webkit-text-size-adjust:100%}:root{--bg-color: #111010;--text-primary: #ffe9c6;--text-secondary: #2AA198;--accent-color: #f97d43;--font-body: "Roboto", sans-serif;--font-code: "JetBrains Mono", monospace}html{font-size:19px}@media (max-width: 480px){html{font-size:16px}}@media (max-width: 360px){html{font-size:15px}}body{font-size:1rem;line-height:1.66;background-color:var(--bg-color);color:var(--text-primary);font-family:var(--font-body);margin:0;padding:0;word-wrap:break-word;overflow-wrap:break-word}h1{font-size:2.25rem;line-height:1.2}h2{font-size:1.75rem;line-height:1.3}h3{font-size:1.35rem;line-height:1.35}@media (max-width: 768px){h1{font-size:2rem}h2{font-size:1.5rem}h3{font-size:1.2rem}}@media (max-width: 480px){h1{font-size:1.75rem}h2{font-size:1.35rem}h3{font-size:1.1rem}}@media (max-width: 360px){h1{font-size:1.6rem}h2{font-size:1.25rem}h3{font-size:1.05rem}}a{color:var(--text-secondary);text-decoration:none}a:hover{text-decoration:underline}pre{background-color:#1e1e1e;border-radius:8px;padding:1rem;overflow-x:auto;margin:1rem 0;font-size:15px;font-family:var(--font-code)}code{background-color:transparent}pre>code{display:block}.toc ul{list-style:none;margin:0;padding:0}.toc li{margin:.5rem 0}.toc a{color:var(--text-secondary);text-decoration:none}.toc a:hover{text-decoration:underline}.toc a.active{font-weight:700;color:var(--accent-color)}nav[data-astro-cid-dmqpwcec]{padding:1rem 0;text-align:center}ul[data-astro-cid-dmqpwcec]{list-style:none;padding:0;margin:0;display:flex;justify-content:center;gap:1.5rem;flex-wrap:wrap}@media (max-width: 480px){ul[data-astro-cid-dmqpwcec]{gap:1rem}a[data-astro-cid-dmqpwcec]{font-size:1rem;padding:.4rem .8rem}}@media (max-width: 360px){ul[data-astro-cid-dmqpwcec]{gap:.5rem}a[data-astro-cid-dmqpwcec]{font-size:.9rem;padding:.3rem .6rem}}li[data-astro-cid-dmqpwcec]{display:inline}a[data-astro-cid-dmqpwcec]{color:var(--text-primary);font-size:1.2rem;padding:.5rem 1rem;border:1px solid transparent;transition:all .3s ease-in-out}a[data-astro-cid-dmqpwcec]:hover{border:1px solid var(--accent-color);border-radius:4px;color:var(--accent-color)}.active[data-astro-cid-dmqpwcec] a[data-astro-cid-dmqpwcec]{color:var(--accent-color);font-weight:700;border-bottom:2px solid var(--accent-color)}hr[data-astro-cid-dmqpwcec]{margin-top:1rem;border:none;height:2px;background:var(--text-secondary);width:90%;max-width:800px;margin-left:auto;margin-right:auto}
.post-title[data-astro-cid-resui2ln]{margin-bottom:2rem}.post-title[data-astro-cid-resui2ln] h1[data-astro-cid-resui2ln]{font-size:1.75rem;color:var(--accent-color);margin:0}.post-date[data-astro-cid-resui2ln]{font-size:1rem;color:var(--text-secondary);margin-top:.5rem}.publish-label[data-astro-cid-resui2ln]{font-weight:700;color:var(--text-primary)}
.chapter[data-astro-cid-5d3zeytc]{font-size:2rem;margin-top:2rem;color:var(--accent-color)}.chapter[data-astro-cid-5d3zeytc] a[data-astro-cid-5d3zeytc]{color:var(--accent-color);text-decoration:none}.chapter[data-astro-cid-5d3zeytc] a[data-astro-cid-5d3zeytc]:hover{text-decoration:underline}
.post-layout{display:flex;flex-direction:row}@media (min-width: 1024px){.post-layout{flex-direction:row}.post-layout-sidebar{position:fixed;left:2rem;top:10rem;width:200px;font-size:.85rem;padding:1rem;z-index:10}.post-layout-content{flex:1;max-width:1000px;margin:0 auto;padding-left:240px;padding-right:2rem}}@media (min-width: 1400px){.post-layout-content{max-width:1200px}}.post-layout-sidebar{display:none}@media (min-width: 1024px){.post-layout-sidebar{display:block}}@media (max-width: 1023px){.post-layout{flex-direction:column}.post-layout-content{width:100%;max-width:100%}}:global(pre){width:100%!important;max-width:100%!important;overflow-x:auto;box-sizing:border-box}:global(.astro-code){width:100%!important;max-width:100%!important;box-sizing:border-box}:global(.astro-code pre){width:100%!important;max-width:100%!important;overflow-x:auto;box-sizing:border-box}:global(.post-layout-content pre){max-width:100%!important;overflow-x:auto;word-wrap:break-word;white-space:pre-wrap}main[data-astro-cid-gvpn4u4b]{padding:2rem 1rem;max-width:900px;margin:0 auto;width:100%;box-sizing:border-box}@media (min-width: 1024px){main[data-astro-cid-gvpn4u4b]{padding:2rem 0;max-width:none}}@media (max-width: 768px){main[data-astro-cid-gvpn4u4b]{padding:1.5rem .75rem}}@media (max-width: 480px){main[data-astro-cid-gvpn4u4b]{padding:1rem .5rem}}article[data-astro-cid-gvpn4u4b]{max-width:800px;width:100%;margin:0 auto;color:var(--text-primary);box-sizing:border-box;word-wrap:break-word;overflow-wrap:break-word}h1[data-astro-cid-gvpn4u4b],h2[data-astro-cid-gvpn4u4b],h3[data-astro-cid-gvpn4u4b]{color:var(--accent-color);margin-top:1.5rem;word-wrap:break-word;overflow-wrap:break-word}p[data-astro-cid-gvpn4u4b]{color:var(--text-secondary);word-wrap:break-word;overflow-wrap:break-word;hyphens:auto}img[data-astro-cid-gvpn4u4b]{max-width:100%;max-height:400px;width:auto;height:auto;border-radius:8px;margin:1rem 0;object-fit:contain}@media (max-width: 768px){img[data-astro-cid-gvpn4u4b]{max-height:300px}}@media (max-width: 480px){img[data-astro-cid-gvpn4u4b]{max-height:250px}}blockquote[data-astro-cid-gvpn4u4b]{border-left:4px solid var(--accent-color);padding-left:1rem;color:var(--text-primary);font-style:italic;margin:1rem 0}code[data-astro-cid-gvpn4u4b]{font-family:monospace;background:#ffffff1a;padding:.2rem .4rem;border-radius:4px;font-size:.95rem}
.image-container[data-astro-cid-6kov3kig]{display:flex;flex-direction:column;align-items:center;margin:1.5rem 0}.image-container[data-astro-cid-6kov3kig] img[data-astro-cid-6kov3kig]{width:auto;height:auto;border-radius:8px;object-fit:contain;box-shadow:0 4px 8px #0000001a}.image-container[data-astro-cid-6kov3kig] img[data-astro-cid-6kov3kig].inverted{filter:invert(1)}.image-caption[data-astro-cid-6kov3kig]{margin-top:.5rem;font-size:.9rem;color:var(--text-secondary, #666);font-style:italic;text-align:center;max-width:600px}@media (max-width: 768px){.image-container[data-astro-cid-6kov3kig]{margin:1rem 0}.image-container[data-astro-cid-6kov3kig] img[data-astro-cid-6kov3kig]{max-height:300px!important}}@media (max-width: 480px){.image-container[data-astro-cid-6kov3kig] img[data-astro-cid-6kov3kig]{max-height:250px!important}.image-caption[data-astro-cid-6kov3kig]{font-size:.8rem;padding:0 1rem}}
</style></head> <body data-astro-cid-gvpn4u4b> <header data-astro-cid-gvpn4u4b> <nav data-astro-cid-dmqpwcec> <ul data-astro-cid-dmqpwcec> <li class data-astro-cid-dmqpwcec> <a href="/" data-astro-cid-dmqpwcec>Posts</a> </li><li class data-astro-cid-dmqpwcec> <a href="/about" data-astro-cid-dmqpwcec>About</a> </li><li class data-astro-cid-dmqpwcec> <a href="/resume.html" data-astro-cid-dmqpwcec>Resume</a> </li> </ul> </nav>  </header> <!-- 
      1) Wrap sidebar + main in a single parent .post-layout
         so flexbox can place them side by side on large screens 
    --> <div class="post-layout" data-astro-cid-gvpn4u4b> <!-- SIDEBAR --> <aside class="post-layout-sidebar" data-astro-cid-gvpn4u4b> <!-- The nav container that will hold our generated TOC --><nav id="table-of-contents" class="toc"></nav> <script client:load>
  window.addEventListener('DOMContentLoaded', () => {
    buildTOC();
    highlightActiveHeading();
  });

  // 1. Build the TOC once the page is loaded
  function buildTOC() {
    const chapterHeadings = Array.from(document.querySelectorAll('h2.chapter[id]'));
    const tocContainer = document.getElementById('table-of-contents');
    if (!tocContainer) return;

    const ul = document.createElement('ul');

    chapterHeadings.forEach((heading) => {
      const li = document.createElement('li');
      const a = document.createElement('a');

      // The heading has an `id` like "intro" or "symptoms"
      a.href = `#${heading.id}`;

      a.textContent = heading.textContent.trim();

      li.appendChild(a);
      ul.appendChild(li);
    });

    tocContainer.appendChild(ul);
  }

    function highlightActiveHeading() {
      const links = Array.from(document.querySelectorAll('#table-of-contents a'));
      const headingEls = links.map((link) => document.getElementById(link.hash.slice(1)));

      // 3. Create the observer
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            console.log(
              `Heading: ${entry.target.id}, isIntersecting: ${entry.isIntersecting}`
            );
            if (entry.isIntersecting) {
              // Remove 'active' from all links
              links.forEach((l) => l.classList.remove('active'));

              // Highlight the link for the heading that just entered
              const activeLink = links.find(
                (l) => l.hash === `#${entry.target.id}`
              );
              if (activeLink) {
                activeLink.classList.add('active');
              }
            }
          });
        },
        {
          root: null,
          rootMargin: '-15% 0px -60% 0px',
          threshold: 0,
        }
      );

      // 4. Observe each heading
      headingEls.forEach((el) => {
        if (el) {
          console.log(`Observing heading: ${el.id}`);
          observer.observe(el);
        }
      });
    }
</script> </aside> <!-- MAIN CONTENT AREA --> <div class="post-layout-content" data-astro-cid-gvpn4u4b> <main data-astro-cid-gvpn4u4b> <article data-astro-cid-gvpn4u4b>  <div class="post-title" data-astro-cid-resui2ln> <h1 data-astro-cid-resui2ln>Home Database</h1> <p class="post-date" data-astro-cid-resui2ln> <span class="publish-label" data-astro-cid-resui2ln>Publish date:</span> 2020-11-11 </p> </div>  <h2 id="intro" class="chapter" data-astro-cid-5d3zeytc> <a href="#intro" data-astro-cid-5d3zeytc>Intro</a> </h2>  <p>
Last month after my daughter was born we've received a bunch
    of documents in this matter. Birth certificate, medical papers,
    assignment of <a href="https://en.wikipedia.org/wiki/PESEL">PESEL</a>,
    etc. When I was about to put those papers into document folders
    I thought it's time for digitalization.
</p> <p>
Most of our very important documents like mortgage papers or university
    diplomas exist only in physical version without any copy either digital or
    physical. We had plans to scan or at least make photos of those but we
    didn't do it. Therefore I thought let's make this right this time.
</p> <p>
Besides documents, in so-called <em>Home App</em> I would also want to keep track of
    usage of water and energy in our home, bank transactions history and list
    of our books.
</p> <h2 id="the-database" class="chapter" data-astro-cid-5d3zeytc> <a href="#the-database" data-astro-cid-5d3zeytc>The database</a> </h2>  <p>
I don't want to store this kind of data on the cloud (someone else's
    computers) directly. Mostly because it is very personal and sensitive. On other hand it
    happens that Google disable accounts without prior notice. Thus I want to build
    something locally, in my internal network, with safe external backups.
</p> <p>
I want my <strong>home DB</strong>, yet abstract bag for home data, to be:
</p> <ul> <li>in form of a single file</li> <li>accessible on multiply platforms and devices</li> <li>structured</li> <li>free</li> </ul> <p>
Based on those criteria I choose <a href="https://www.sqlite.org/index.html">SQLite</a>.
    It works everywhere, it can store files in a raw format (blob), it's
    self-contained, it's free and it's probably
<a href="https://news.ycombinator.com/item?id=18685748">the most tested</a>
non-trivial program ever written. I also personally like SQLite for being
    minimalistic. Setup is trivial or even nonexistent.
</p> <p>
Finally I'll be having a single database file
    containing all of my and my family important files from our adult life.
    That sounds serious. We'll back to that in <em>Security</em> section.
</p> <p>
Wait... But how can I upload my files and data to this database? Yep, I'm also
    developing <strong>Home App</strong>.
</p> <h2 id="home-app" class="chapter" data-astro-cid-5d3zeytc> <a href="#home-app" data-astro-cid-5d3zeytc>Home App</a> </h2>  <div class="image-container" data-astro-cid-6kov3kig> <img src="/home-db/documents.png" alt="Home App documents interface" style="max-width: 100%; max-height: 400px;" class data-astro-cid-6kov3kig> <p class="image-caption" data-astro-cid-6kov3kig>Home App documents interface</p> </div>  <p>
Still the main "product" of this life-long project is the database but to make
    it more comfortable to operate on this DB I need some kind of application.
    I have decided to build a web application which would run on my local network.
    I choose
<a href="https://docs.microsoft.com/en-us/aspnet/core/tutorials/first-mvc-app/start-mvc?view=aspnetcore-3.1&tabs=visual-studio">ASP.NET Core MVC</a>
(C#) over Go because all SQL drivers for SQLite in Go
    uses <em>cgo</em>.
</p> <p>
As you can see above I'm not focused much on the UI side. Maybe someday but not
    in foreseeable future. Main goals for this app is to ensure data insertion
    layer both for documents (files) and other data. Secondly to give a quick view
    on data. For example if I want to check my diploma from high school I should be
    able to do it quickly through the UI.
</p> <p>
It doesn't need to be a complete application with coverage of all
    functionalities and corner cases. This application will be used literally by
    1-4 users in local network. If something throw exception I could quickly pick
    it up. It sounds like very comfortable assumptions for developer and in fact it
    is. That made it possible for me to implement most of functionalities in couple
    of evenings.
</p> <p>
MVC over Go have one more advantage for me. It has already bootstrap setup so
    this application is also usable from my mobile phone without any extra effort.
    For someone who avoid frontend technologies it was significant advantage.
    It's useful when I go to the hall to check my water and energy usage. In this
    case I can fill the forms directly on my smartphone.
</p> <p>
In the moment of writing this post repo with source code of <em>Home App</em> is
    private but I might make it public someday.
</p> <h2 id="data-uploading" class="chapter" data-astro-cid-5d3zeytc> <a href="#data-uploading" data-astro-cid-5d3zeytc>Data uploading</a> </h2>  <p>
Till this point I've setup SQLite database and connected web app for uploading
    and accessing data. So now I could focus on actually using the <em>Home App</em> to
    populate <em>Home DB</em>.
</p> <p>
Regarding water and energy usage in home I manually check water counter and
    energy counter at evening every fifth day. I think it's a good middle ground.
    Daily basis wouldn't be possible and monthly basis would be rather too rarely.
</p> <p>
Regarding financial transactions. Once a month I download XML with all
    transactions from my bank. Part of <em>Home App</em> parses and uploads this XML into
    appropriate table in the DB. Only manual work here is to download XML once a
    month which doesn't seems like a problem. Maybe one day there will be API for
    that? I hope so.
</p> <p>
Digitalization of documents is for sure the most time-consuming part of
    uploading data. In most cases I have to scan actual physical paper sheets. When
    I've discovered there are tiny scanners I immediately bought one:
</p> <div class="image-container" data-astro-cid-6kov3kig> <img src="/home-db/scanner.gif" alt="Tiny scanner demonstration" style="max-width: 100%; max-height: 400px;" class data-astro-cid-6kov3kig> <p class="image-caption" data-astro-cid-6kov3kig>Tiny scanner demonstration</p> </div>  <p>
On evening when scanner arrived I've scanned around 35 documents. There is
    still many more but even after this sample I felt it was a very good choice.
    It'll probably took me at least few evening to scan significant documents but
    once that will be done keeping up with new ones will not require much effort.
</p> <div class="image-container" data-astro-cid-6kov3kig> <img src="/home-db/upload.png" alt="Document upload interface" style="max-width: 100%; max-height: 400px;" class data-astro-cid-6kov3kig> <p class="image-caption" data-astro-cid-6kov3kig>Document upload interface</p> </div>  <h2 id="security-backups" class="chapter" data-astro-cid-5d3zeytc> <a href="#security-backups" data-astro-cid-5d3zeytc>Security and backups</a> </h2>  <p>
As I stated before security is one of most crucial aspects of this project. I
    could do local backups on my HD and SSD drives but preferably I'd like to have
    safe backups on the Web to be able to reach for those outside my home or even
    on new device. If only there would be some safe and anonymous way to do online
    backups...
</p> <p>
Fortunately there is <a href="https://www.tarsnap.com/">Tarsnap</a> - <em>"Online
    backups for the truly paranoid"</em> by Dr. Colin Percival. It's a tool for secure
    and efficient online backups. Tarsnap security is based on <em>key file</em> which is
    generated during account setup. Only person with that key file can access your
    backups. The key file is generated locally on the client's device. Therefore
    even Tarsnap cannot restore your backups in case when you lost your key file.
    It uses very strong encryption, details can be read
<a href="https://www.tarsnap.com/crypto.html">here</a>. It also a have cool feature which
    is deduplication. Only new bytes in comparison to previous backup are
    compressed, encrypted and send onto servers.
</p> <p>
Tarsnap works under UNIX-like OS. On my main PC I use Linux so everything went
    smooth. I've tested it also on my Windows Laptop using Windows Subsystem for
    Linux and Ubuntu 20 to configure Tarsnap. Once again there wasn't any problems.
    Note that on the Windows box I had to put my original key file from my main PC.
    Generating new key would create a new namespace for backups even under the same
    Tarsnap account.
</p> <p>
Besides secure backups <em>Home App</em> is hosted on my local (home) network and also
    authentication is setup. So even someone would get into my network during
    application is listening then he/she have to also hack the <em>Home App</em>. That is
    very unlikely.
</p> <p>
Even if someone would steal my main PC and brute force my password and finally
    get hands on my personal data that is still better then stealing my physical
    documents. Backup can be restored with no cost. "Restoring" physical documents
    wouldn't probably be possible in many cases without having <em>Home DB</em>.
</p> <h2 id="summary" class="chapter" data-astro-cid-5d3zeytc> <a href="#summary" data-astro-cid-5d3zeytc>Summary</a> </h2>  <p>
Having <strong>Home DB</strong> makes me feel secure and be in control of my personal
    data. It's priceless.
    The power of querying through several years of your personal finance or
    browsing through specific kind of invoices effortlessly without need to go
    through sorting physical folders and papers is amazing. It was definitely worth
    the effort to put together the database and the app.
</p> <p>
Probably next steps would be to extend data scheme and introduce data analytic
    and visualization layer into <em>Home App</em>. As I said it is a life-long project of
    storing and analyzing my and my family data. I'm sure there would be plenty
    improvements and extensions. I will probably write another post someday on
    this.
</p> <p>
I'm very excited about this project. I find this idea (digitalization of
    personal data and assets) very attractive. I wonder if there is a market for
    this kind of service (not a product, but whole service)? But this is for another time.
</p>  </article> </main> </div> </div>  <!-- Global styles for .post-layout and .post-layout-sidebar -->  </body></html>