<!DOCTYPE html><html lang="en" data-astro-cid-gvpn4u4b> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>I&#39;m quitting cmd</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.26/dist/katex.min.css" crossorigin="anonymous"><style>*,*:before,*:after{box-sizing:border-box}html,body{max-width:100%;overflow-x:hidden}html{-webkit-text-size-adjust:100%}:root{--bg-color: #111010;--text-primary: #ffe9c6;--text-secondary: #2AA198;--accent-color: #f97d43;--font-body: "Roboto", sans-serif;--font-code: "JetBrains Mono", monospace}html{font-size:19px}@media (max-width: 480px){html{font-size:16px}}@media (max-width: 360px){html{font-size:15px}}body{font-size:1rem;line-height:1.66;background-color:var(--bg-color);color:var(--text-primary);font-family:var(--font-body);margin:0;padding:0;word-wrap:break-word;overflow-wrap:break-word}h1{font-size:2.25rem;line-height:1.2}h2{font-size:1.75rem;line-height:1.3}h3{font-size:1.35rem;line-height:1.35}@media (max-width: 768px){h1{font-size:2rem}h2{font-size:1.5rem}h3{font-size:1.2rem}}@media (max-width: 480px){h1{font-size:1.75rem}h2{font-size:1.35rem}h3{font-size:1.1rem}}@media (max-width: 360px){h1{font-size:1.6rem}h2{font-size:1.25rem}h3{font-size:1.05rem}}a{color:var(--text-secondary);text-decoration:none}a:hover{text-decoration:underline}pre{background-color:#1e1e1e;border-radius:8px;padding:1rem;overflow-x:auto;margin:1rem 0;font-size:15px;font-family:var(--font-code)}code{background-color:transparent}pre>code{display:block}.toc ul{list-style:none;margin:0;padding:0}.toc li{margin:.5rem 0}.toc a{color:var(--text-secondary);text-decoration:none}.toc a:hover{text-decoration:underline}.toc a.active{font-weight:700;color:var(--accent-color)}nav[data-astro-cid-dmqpwcec]{padding:1rem 0;text-align:center}ul[data-astro-cid-dmqpwcec]{list-style:none;padding:0;margin:0;display:flex;justify-content:center;gap:1.5rem;flex-wrap:wrap}@media (max-width: 480px){ul[data-astro-cid-dmqpwcec]{gap:1rem}a[data-astro-cid-dmqpwcec]{font-size:1rem;padding:.4rem .8rem}}@media (max-width: 360px){ul[data-astro-cid-dmqpwcec]{gap:.5rem}a[data-astro-cid-dmqpwcec]{font-size:.9rem;padding:.3rem .6rem}}li[data-astro-cid-dmqpwcec]{display:inline}a[data-astro-cid-dmqpwcec]{color:var(--text-primary);font-size:1.2rem;padding:.5rem 1rem;border:1px solid transparent;transition:all .3s ease-in-out}a[data-astro-cid-dmqpwcec]:hover{border:1px solid var(--accent-color);border-radius:4px;color:var(--accent-color)}.active[data-astro-cid-dmqpwcec] a[data-astro-cid-dmqpwcec]{color:var(--accent-color);font-weight:700;border-bottom:2px solid var(--accent-color)}hr[data-astro-cid-dmqpwcec]{margin-top:1rem;border:none;height:2px;background:var(--text-secondary);width:90%;max-width:800px;margin-left:auto;margin-right:auto}
.post-title[data-astro-cid-resui2ln]{margin-bottom:2rem}.post-title[data-astro-cid-resui2ln] h1[data-astro-cid-resui2ln]{font-size:1.75rem;color:var(--accent-color);margin:0}.post-date[data-astro-cid-resui2ln]{font-size:1rem;color:var(--text-secondary);margin-top:.5rem}.publish-label[data-astro-cid-resui2ln]{font-weight:700;color:var(--text-primary)}
.chapter[data-astro-cid-5d3zeytc]{font-size:2rem;margin-top:2rem;color:var(--accent-color)}.chapter[data-astro-cid-5d3zeytc] a[data-astro-cid-5d3zeytc]{color:var(--accent-color);text-decoration:none}.chapter[data-astro-cid-5d3zeytc] a[data-astro-cid-5d3zeytc]:hover{text-decoration:underline}
.post-layout{display:flex;flex-direction:row}@media (min-width: 1024px){.post-layout{flex-direction:row}.post-layout-sidebar{position:fixed;left:2rem;top:10rem;width:200px;font-size:.85rem;padding:1rem;z-index:10}.post-layout-content{flex:1;max-width:1000px;margin:0 auto;padding-left:240px;padding-right:2rem}}@media (min-width: 1400px){.post-layout-content{max-width:1200px}}.post-layout-sidebar{display:none}@media (min-width: 1024px){.post-layout-sidebar{display:block}}@media (max-width: 1023px){.post-layout{flex-direction:column}.post-layout-content{width:100%;max-width:100%}}:global(pre){width:100%!important;max-width:100%!important;overflow-x:auto;box-sizing:border-box}:global(.astro-code){width:100%!important;max-width:100%!important;box-sizing:border-box}:global(.astro-code pre){width:100%!important;max-width:100%!important;overflow-x:auto;box-sizing:border-box}:global(.post-layout-content pre){max-width:100%!important;overflow-x:auto;word-wrap:break-word;white-space:pre-wrap}main[data-astro-cid-gvpn4u4b]{padding:2rem 1rem;max-width:900px;margin:0 auto;width:100%;box-sizing:border-box}@media (min-width: 1024px){main[data-astro-cid-gvpn4u4b]{padding:2rem 0;max-width:none}}@media (max-width: 768px){main[data-astro-cid-gvpn4u4b]{padding:1.5rem .75rem}}@media (max-width: 480px){main[data-astro-cid-gvpn4u4b]{padding:1rem .5rem}}article[data-astro-cid-gvpn4u4b]{max-width:800px;width:100%;margin:0 auto;color:var(--text-primary);box-sizing:border-box;word-wrap:break-word;overflow-wrap:break-word}h1[data-astro-cid-gvpn4u4b],h2[data-astro-cid-gvpn4u4b],h3[data-astro-cid-gvpn4u4b]{color:var(--accent-color);margin-top:1.5rem;word-wrap:break-word;overflow-wrap:break-word}p[data-astro-cid-gvpn4u4b]{color:var(--text-secondary);word-wrap:break-word;overflow-wrap:break-word;hyphens:auto}img[data-astro-cid-gvpn4u4b]{max-width:100%;max-height:400px;width:auto;height:auto;border-radius:8px;margin:1rem 0;object-fit:contain}@media (max-width: 768px){img[data-astro-cid-gvpn4u4b]{max-height:300px}}@media (max-width: 480px){img[data-astro-cid-gvpn4u4b]{max-height:250px}}blockquote[data-astro-cid-gvpn4u4b]{border-left:4px solid var(--accent-color);padding-left:1rem;color:var(--text-primary);font-style:italic;margin:1rem 0}code[data-astro-cid-gvpn4u4b]{font-family:monospace;background:#ffffff1a;padding:.2rem .4rem;border-radius:4px;font-size:.95rem}
</style></head> <body data-astro-cid-gvpn4u4b> <header data-astro-cid-gvpn4u4b> <nav data-astro-cid-dmqpwcec> <ul data-astro-cid-dmqpwcec> <li class data-astro-cid-dmqpwcec> <a href="/" data-astro-cid-dmqpwcec>Posts</a> </li><li class data-astro-cid-dmqpwcec> <a href="/about" data-astro-cid-dmqpwcec>About</a> </li><li class data-astro-cid-dmqpwcec> <a href="/resume.html" data-astro-cid-dmqpwcec>Resume</a> </li> </ul> </nav>  </header> <!-- 
      1) Wrap sidebar + main in a single parent .post-layout
         so flexbox can place them side by side on large screens 
    --> <div class="post-layout" data-astro-cid-gvpn4u4b> <!-- SIDEBAR --> <aside class="post-layout-sidebar" data-astro-cid-gvpn4u4b> <!-- The nav container that will hold our generated TOC --><nav id="table-of-contents" class="toc"></nav> <script client:load>
  window.addEventListener('DOMContentLoaded', () => {
    buildTOC();
    highlightActiveHeading();
  });

  // 1. Build the TOC once the page is loaded
  function buildTOC() {
    const chapterHeadings = Array.from(document.querySelectorAll('h2.chapter[id]'));
    const tocContainer = document.getElementById('table-of-contents');
    if (!tocContainer) return;

    const ul = document.createElement('ul');

    chapterHeadings.forEach((heading) => {
      const li = document.createElement('li');
      const a = document.createElement('a');

      // The heading has an `id` like "intro" or "symptoms"
      a.href = `#${heading.id}`;

      a.textContent = heading.textContent.trim();

      li.appendChild(a);
      ul.appendChild(li);
    });

    tocContainer.appendChild(ul);
  }

    function highlightActiveHeading() {
      const links = Array.from(document.querySelectorAll('#table-of-contents a'));
      const headingEls = links.map((link) => document.getElementById(link.hash.slice(1)));

      // 3. Create the observer
      const observer = new IntersectionObserver(
        (entries) => {
          entries.forEach((entry) => {
            console.log(
              `Heading: ${entry.target.id}, isIntersecting: ${entry.isIntersecting}`
            );
            if (entry.isIntersecting) {
              // Remove 'active' from all links
              links.forEach((l) => l.classList.remove('active'));

              // Highlight the link for the heading that just entered
              const activeLink = links.find(
                (l) => l.hash === `#${entry.target.id}`
              );
              if (activeLink) {
                activeLink.classList.add('active');
              }
            }
          });
        },
        {
          root: null,
          rootMargin: '-15% 0px -60% 0px',
          threshold: 0,
        }
      );

      // 4. Observe each heading
      headingEls.forEach((el) => {
        if (el) {
          console.log(`Observing heading: ${el.id}`);
          observer.observe(el);
        }
      });
    }
</script> </aside> <!-- MAIN CONTENT AREA --> <div class="post-layout-content" data-astro-cid-gvpn4u4b> <main data-astro-cid-gvpn4u4b> <article data-astro-cid-gvpn4u4b>  <div class="post-title" data-astro-cid-resui2ln> <h1 data-astro-cid-resui2ln>I&#39;m quitting cmd</h1> <p class="post-date" data-astro-cid-resui2ln> <span class="publish-label" data-astro-cid-resui2ln>Publish date:</span> 2020-08-05 </p> </div>  <h2 id="background" class="chapter" data-astro-cid-5d3zeytc> <a href="#background" data-astro-cid-5d3zeytc>Background</a> </h2>  <p>
Regarding operating systems I prefer Linux over Windows. Even though in my job
    I'm forced to use Windows. To make my work on Windows more pleasant I've been 
    using Command-line alongside with vim, grep, AWK and other Unix/Linux tools.
</p> <p>
Using cmd before Windows 10 was not a very visual appealing experience. It
    suppose to be just a rectangle box with a text and somehow they made it hard to
    read and write text. In Windows 10 cmd was visually improved. It started to
    look modern and more like other Linux terminals.
</p> <p>
For the last five years I've been using Command-line on Windows 10. 
    So what suddenly have changed my mind? PowerShell.
</p> <p>
I always have been conscious that PowerShell exists but I've never give it a
    try. Why? To be honest because of it's horrible default dark blue background color.
    Recently I've got a task to extend some PowerShell script and I found out it's a great
    tool! And also I've configured <a href="https://conemu.github.io/">ConEmu</a> to use
    PowerShell as a default shell with the same appearance as cmd (black
    background and white JetBrains mono). That was the beginning of new chapter of my
    life.
</p> <h2 id="what-is-powershell" class="chapter" data-astro-cid-5d3zeytc> <a href="#what-is-powershell" data-astro-cid-5d3zeytc>What is PowerShell?</a> </h2>  <p>
PowerShell is a framework from Microsoft consisting of scripting language and
    command-line shell built on top of .NET CLR. In 2016 PowerShell was moved to
    .NET Core which made it cross-platform and moreover it was open-sourced in
    August 2016 (under name PowerShell Core).
</p> <p>
So basically it's a better command-line (not only) for Windows. How better?
    Let's find out.
</p> <h2 id="benefits-of-powershell-over-cmd" class="chapter" data-astro-cid-5d3zeytc> <a href="#benefits-of-powershell-over-cmd" data-astro-cid-5d3zeytc>Benefits of PowerShell over cmd</a> </h2>  <p>
Here I've selected top features of PowerShell which in my opinion make it
    superior to standard cmd.
</p> <h3>Pipes</h3> <p>
For me most pain from using cmd comes from absence of Unix-like pipes. Unix
    pipe is an operator "|" (ASCII 124) and it takes an output of the previous
    process and treats it as input to the current process. It's a basis of Unix
    philosophy of composing programs introduced and implemented by Douglas Mcllroy
    and Ken Thompson around 1973 in Bell Labs. PowerShell got them!
</p> <pre class="astro-code dark-plus" style="background-color:#1E1E1E;color:#D4D4D4; overflow-x: auto;" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#D4D4D4">ls -Recurse *.txt | </span><span style="color:#DCDCAA">Get-Content</span><span style="color:#D4D4D4"> | Measure -l -w -c</span></span></code></pre> <p>
The example above get a list of all text files from all sub-catalogs, get their
    content and finally count number of lines, words and characters.
</p> <h3>Object-based</h3> <p>
In traditional shells usual output from program is just text which can be input
    to another program which will produce another text output and so on. In this
    environment very common is combination of programs like grep, AWK and sed 
    to deal with those streams of text.
</p> <p>
PowerShell on contrary is object-based. Output of standard PowerShell utilities
    are .NET objects. To access object's properties and methods dot notation is
    used.
</p> <pre class="astro-code dark-plus" style="background-color:#1E1E1E;color:#D4D4D4; overflow-x: auto;" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#9CDCFE">$fileList</span><span style="color:#D4D4D4"> = ls</span></span>
<span class="line"><span style="color:#9CDCFE">$file5</span><span style="color:#D4D4D4"> = </span><span style="color:#9CDCFE">$fileList</span><span style="color:#D4D4D4">[</span><span style="color:#B5CEA8">5</span><span style="color:#D4D4D4">]</span></span>
<span class="line"><span style="color:#DCDCAA">Write-Host</span><span style="color:#CE9178"> "File"</span><span style="color:#9CDCFE"> $file5</span><span style="color:#DCDCAA">.FullName</span><span style="color:#CE9178"> "was created"</span><span style="color:#9CDCFE"> $file5</span><span style="color:#DCDCAA">.CreationTime</span></span></code></pre> <p>
In the above example we've created <code>$fileList</code> (dollar sign have to precede
    variable name) which is an array of objects representing files. It's not an
    array of strings. It's an array of actual objects representing files. Next we
    defined <code>$file5</code> which is an object representing 6th element of <code>ls</code>. Formally
<code>$file5</code> is of type <code>FileInfo</code> and have about fifty properties and methods. For
    example <code>FullName</code> and <code>CreationTime</code> properties which we used to print custom
    message but also methods like <code>$file5.Open()</code> which returns
<code>System.IO.FileStream</code> which is regular .NET object representing a file stream.
    For C#, F# or VB programmers it's a very good news.
</p> <pre class="astro-code dark-plus" style="background-color:#1E1E1E;color:#D4D4D4; overflow-x: auto;" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#D4D4D4">ls -Recurse *.go | </span><span style="color:#DCDCAA">Where-Object</span><span style="color:#D4D4D4"> {</span><span style="color:#9CDCFE">$_</span><span style="color:#DCDCAA">.CreationTime</span><span style="color:#D4D4D4"> -ge </span><span style="color:#CE9178">'2020-07-25'</span><span style="color:#D4D4D4">}</span></span></code></pre> <p>
Another example displays how expressive it can be. This particular example
    lists all of files with <code>.go</code> extension from all sub-catalogs which was created
    after <code>2020-07-25</code>. Notation <code>$_</code> represents current value in the pipeline.
</p> <h3>Integration with .NET</h3> <p>
PowerShell is built on top of .NET thus integration with .NET is natural.
    Why that matters? For instance we can use C# standard libraries from
    PowerShell:
</p> <pre class="astro-code dark-plus" style="background-color:#1E1E1E;color:#D4D4D4; overflow-x: auto;" tabindex="0" data-language="powershell"><code><span class="line"><span style="color:#9CDCFE">$rand</span><span style="color:#D4D4D4"> = [</span><span style="color:#569CD6">System.Random</span><span style="color:#D4D4D4">]::new()</span></span>
<span class="line"><span style="color:#9CDCFE">$rand</span><span style="color:#DCDCAA">.Next</span><span style="color:#D4D4D4">(</span><span style="color:#B5CEA8">10</span><span style="color:#D4D4D4">, </span><span style="color:#B5CEA8">100</span><span style="color:#D4D4D4">)</span></span></code></pre> <p>
We just used standard C# <code>System.Random.Random</code> object to generate pseudorandom
    integers. How cool is that? In particular you can use your C# functionalities
    for scripting! Sometimes that might be useful.
</p> <p>
Another point is that you can define your own PowerShell cmdlets written in C#
    or F#.
</p> <h3>Tab completion</h3> <p>
PowerShell have a very good tab completion in comparison to cmd.
</p> <h3>Aliases</h3> <p>
PowerShell on default configuration have a very broad set of aliases for native
    functionalities. We have already seen <code>ls</code> "command". In fact <code>ls</code> is just an
    alias for <code>Get-ChildItem</code> cmdlet. Besides <code>ls</code> it has predefined other aliases -
<code>gci</code> and <code>dir</code>. So both Linux and Windows cmd users won't have trouble to get
    a list of elements in given location. We can easy add new aliases for
    existing cmdlets using <code>Set-Alias</code> cmdlet.
</p> <p>
There is one more advantage of having full name cmdlets and their aliases. When
    you're writing a PowerShell script you can use full name to increase
    readability and when you're just fooling around in terminal you can just use
    aliases for compactness and laziness of typing.
</p> <blockquote> <p>
A cmdlet is a lightweight command that is used in the PowerShell environment. 
      The PowerShell runtime invokes these cmdlets within the context of automation 
      scripts that are provided at the command line.
</p> <footer>â€” Microsoft Docs</footer> </blockquote> <h2 id="transition-to-powershell" class="chapter" data-astro-cid-5d3zeytc> <a href="#transition-to-powershell" data-astro-cid-5d3zeytc>Transition to PowerShell</a> </h2>  <p>
Transition from Windows Command-line to PowerShell was very easy! Taking into
    account aliases and rather good (better then cmd) built-in help I've replaced
    cmd with PowerShell in one day. Without any effort! All of programs I've been
    using in cmd works without any difference in PowerShell. And what is most
    important now I feel that Windows is under my control and not the other way.
    More like on Linux. I very like that.
</p> <p>
I've basically just started my journey with PowerShell but I'm sure that it
    will continue as long as I'll be forced to use Windows.
</p> <h2 id="summary" class="chapter" data-astro-cid-5d3zeytc> <a href="#summary" data-astro-cid-5d3zeytc>Summary</a> </h2>  <p>
If you're Windows user or you're forced to use Windows and you want to get near
    Linux-like experience using terminal then go for PowerShell. Transition is
    effortless and you can easily change horrible default dark blue background
    color. And final gain is massive, especially if you're already a .NET developer.
    I think it is already one of my better choices regarding tooling, right after vim
    and AWK (not mentioning git which is obligatory nowadays).
</p> <h2 id="references" class="chapter" data-astro-cid-5d3zeytc> <a href="#references" data-astro-cid-5d3zeytc>References</a> </h2>  <ol> <li><a href="https://docs.microsoft.com/en-us/powershell/scripting/overview?view=powershell-7">What is PoweShell</a></li> <li><a href="https://en.wikipedia.org/wiki/PowerShell">Wiki</a></li> <li><a href="https://www.youtube.com/watch?v=EY6q5dv_B-o">Brian Kernighan interviews Ken Thompson</a></li> <li><a href="https://docs.microsoft.com/en-us/powershell/scripting/developer/cmdlet/cmdlet-overview?view=powershell-7">Cmdlet overview</a></li> </ol>  </article> </main> </div> </div>  <!-- Global styles for .post-layout and .post-layout-sidebar -->  </body></html>